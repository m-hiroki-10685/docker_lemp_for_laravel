version: '3.8'
services:
 nginx:
   image: nginx:latest
   ports:
    - 80:80
   volumes:
    - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf
    - ./web:/var/www/html
   depends_on:
    - php
   restart: always

 php:
  build: ./php
  volumes:
   - ./web:/var/www/html
  depends_on:
   - mysql
  restart: always

 mysql:
  build: ./mysql
  ports:
   - 3306:3306
  volumes:
   - db-data:/var/lib/mysql
  environment:
   MYSQL_DATABASE: laravel
   MYSQL_ROOT_PASSWORD: testtest
  restart: always

 phpmyadmin:
  image: phpmyadmin/phpmyadmin:latest
  environment:
   PMA_HOST: mysql
  ports:
   - 8080:80
  depends_on:
   - mysql
  restart: always

 mail:
  image: mailhog/mailhog
  ports:
   - 8025:8025

volumes:
 db-data:
